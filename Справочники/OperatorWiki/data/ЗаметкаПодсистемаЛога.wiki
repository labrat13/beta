++ Заметка Подсистема Лога

+++Подсистема Лога
* Вести список неопознанных команд, с таймштампом события.
* вести лог ввода-вывода консоли пользователя. С таймштампом события, кодом события. В рамках сеанса лога, по одному файлу на сеанс.
* Вести общий лог событий Оператора. С таймштампом события, кодом события. Полный, по одному файлу на сеанс.
* Управлять файлами лога: по ХХ мегабайт на каждый вид лога, более старые удалять. Сеансы тоже как в Тапп.
* Нужны прототипы функций:
    * Запись нераспознанной команлы
    * Запись события в лог консоли пользователя
    * Запись события с лог Оператора
    * Инициализация лога (Начало сеанса Оператора)
    * Завершение лога (/Конец сеанса Оператора)
    * Каталог лога (Проперти String)
        * Требуется файловая система Оператора
* Похоже на логи Тапп? Кое-что можно оттуда взять? Сделать универсальный класс для моих проектов?
* Нужен файл настроек Оператора, подобно Тапп.
* Нужно закрывать файлы лога, когда нет действий пользователя (Более 1 минуты?)
* Нужно хранить файлы Оператора в собственном каталоге (RWX права?)
* В логе формат CSV не годится, так как тексты обычно содержат переводы строк. Придется XML использовть. Но его нельзя завершать как попало!
* Для каждого вида лога - свой счетчик таймера лога?
    * пока один на все логи. Нужно сделать модель (имеющегося кода в UML?), выяснить, куда пишутся события разных видов. 

++++Вопросы
1. Как выявлять момент закрытия файлов лога по таймауту? Нужен таймер - счетчик секунд и событий секунд.
    * если событийтаймера нет, то и отключение по таймауту не будет работать. Все ОК!
    * Открывать файлы по необходимости, сбрасывать счетчик секунд.
2. Нужно взять из Тапп управление папками сеансов и файлами сеансов; ограничение размера лога; всех логов;сеанса лога; создание каталога сеанса лога и файлов в нем.
    * Нужен объект Настроек Оператора
3. Надо где-то хранить Настройки Оператора
    * Нужен макет Каталог Оператора
    * Нужно где-то реализовать управление каталогом Оператора
    * Каталог для Пакетов Знаний - папка, в ней искать Пакеты Знаний будет Оператор при инициализации. Но это потм. Сейчас просто выделить папку и файл-описание каталога.
    * Нужна функция создания нового каталога Оператора вместе с новой пустой БД и заполнения БД?
4. Надо заменить в инсталяторе путь для Оператора на "C:\", а то в Program Files нельзя хранить данные программы.
5. Нужно писать лог общий в формате XML, лог консоли в формате XML, лог нераспознанных команд в формате XML.
    * Нужен XML Writer, закрывать его при простое, снова открывать при попытке записи в него.
    * Он должен дописывать в конец файла.
    * Строка вида <msg p="default" t="text" d="01.04.1989" /> примерно так, данные писать в атрибуты ноды.
   